import os, sys


# introduction:不重复地合并两个域名资产/一个域名资产的过滤
# python3 combine_assets.py asset1.txt "" # 处理一个
# python3 combine_assets.py asset1.txt asset2.txt # 处理两个
def read_file(filename):
    rows_filter = []
    with open(filename, "r") as f:
        rows = f.readlines()
        last_line = rows[-1]
        if last_line[-1] != "\n":
            rows[-1] = rows[-1] + "\n"
    f.close()
    for row in rows:
        if row not in rows_filter:
            rows_filter.append(row)
    return rows_filter


if __name__ == "__main__":
    if len(sys.argv) != 3:
        print("usage:python3 combine_assets.py [target1.txt] [target2.txt]")
        exit(0)
    filename1 = sys.argv[1]
    filename2 = sys.argv[2]
    with open(filename1, "r") as f1:
        total_list = read_file(filename1)
    f1.close()
    if filename2 != "":
        with open(filename2, "r") as f2:
            for row in f2.readlines():
                if row not in total_list:
                    total_list.append(row)
        # list2=read_file(filename2)
        # for one in list2:
        # 	if one not in total_list:
        # 		total_list.append(one)
        f2.close()
        with open(filename1.replace(".txt", "") + "_" + filename2.replace(".txt", "") + ".txt", "w") as f:
            f.writelines(total_list)
        f.close()
        print("combine two file {} and {} ok".format(filename1, filename2))
    else:
        with open(filename1, "w") as f:
            f.writelines(total_list)
        f.close()
        print("filter file {} ok".format(filename1))
